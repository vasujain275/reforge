# ============================================================================
# REFORGE DOCKER COMPOSE ENVIRONMENT CONFIGURATION
# ============================================================================
# This file contains environment variables for Docker Compose deployment.
# Copy this file to .env and customize the values before running docker compose.
#
# Quick Start:
#   cp .env.sample .env
#   vim .env  # Edit JWT_SECRET and DB_PASSWORD
#   docker compose up -d
#
# The application will be available at: http://localhost:9173
# ============================================================================

# ============================================================================
# REQUIRED SECRETS - MUST BE CHANGED BEFORE DEPLOYMENT
# ============================================================================

# JWT Secret for authentication tokens
# SECURITY: Generate a strong random secret for production!
# Generate: openssl rand -base64 32
JWT_SECRET=your-super-secret-jwt-key-change-me

# Database password for PostgreSQL
# SECURITY: Generate a strong random password for production!
# Generate: openssl rand -base64 32
DB_PASSWORD=your-strong-database-password-change-me

# ============================================================================
# SERVER CONFIGURATION
# ============================================================================

# Server bind address and port
# Default: 0.0.0.0:9173 (accessible from host machine)
ADDR=0.0.0.0:9173

# Environment mode: 'dev' or 'prod'
# - prod: Production optimizations, stricter security (recommended for Docker)
# - dev: Detailed logging, development features
ENV=prod

# ============================================================================
# DATABASE CONFIGURATION (PostgreSQL 18)
# ============================================================================

# PostgreSQL port exposed on host machine
# Default: 5432
# Change if you have another PostgreSQL instance running on the same port
POSTGRES_PORT=5432

# PostgreSQL connection string (libpq format)
# For Docker Compose: Use internal hostname 'postgres'
# For external DB: Replace with your PostgreSQL instance hostname/IP
#
# Format: postgresql://[user[:password]@][host][:port][/dbname][?param1=value1&...]
#
# Docker internal (default):
#   postgresql://reforge:${DB_PASSWORD}@postgres:5432/reforge?sslmode=disable
#
# External PostgreSQL:
#   postgresql://username:password@your-postgres-host:5432/reforge?sslmode=require
DATABASE_URL=postgresql://reforge:${DB_PASSWORD}@postgres:5432/reforge?sslmode=disable

# Database driver for migrations
GOOSE_DRIVER=postgres

# ============================================================================
# BRING YOUR OWN POSTGRESQL (OPTIONAL)
# ============================================================================
# If you have an existing PostgreSQL 18+ instance:
#
# 1. Comment out the 'postgres' service in docker-compose.yaml
# 2. Update DATABASE_URL above to point to your instance
# 3. Ensure the database 'reforge' exists:
#      psql -U postgres -c "CREATE DATABASE reforge;"
# 4. Migrations will run automatically on container startup
#
# Example external connection:
#   DATABASE_URL=postgresql://myuser:mypass@db.example.com:5432/reforge?sslmode=require

# ============================================================================
# SCORING ALGORITHM WEIGHTS (OPTIONAL)
# ============================================================================

# Reforge uses a deterministic 7-feature weighted scoring formula.
# These values should sum to 1.0 for optimal scoring.
# Admins can customize these at runtime via the UI.
#
# Defaults (if not set):
DEFAULT_W_CONF=0.30
DEFAULT_W_DAYS=0.20
DEFAULT_W_ATTEMPTS=0.10
DEFAULT_W_TIME=0.05
DEFAULT_W_DIFFICULTY=0.15
DEFAULT_W_FAILED=0.10
DEFAULT_W_PATTERN=0.10

# ============================================================================
# ADMIN SEEDING (OPTIONAL - FIRST-TIME SETUP)
# ============================================================================

# Automatically create admin user if none exists on first startup
# RECOMMENDED: Use /onboarding endpoint instead for better security
#
# Uncomment to enable auto-seeding:
# SEED_ADMIN_EMAIL=admin@reforge.local
# SEED_ADMIN_NAME=System Administrator
# SEED_ADMIN_PASSWORD=ChangeMeImmediately123!

# ============================================================================
# SIGNUP SETTINGS (OPTIONAL)
# ============================================================================

# Allow new user registrations (true/false)
DEFAULT_SIGNUP_ENABLED=true

# Allow admin-generated invite codes when signup is disabled (true/false)
DEFAULT_INVITE_CODES_ENABLED=true

# ============================================================================
# DATA IMPORT (OPTIONAL)
# ============================================================================

# Path to bundled CSV datasets for bulk problem import
# Default: ./sample-datasets (contains leetcode.csv with 2000+ problems)
# DATASET_PATH=/app/sample-datasets
